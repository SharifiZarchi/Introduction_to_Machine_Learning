\textbf{شبکه عصبی کانولوشنال (21 نمره)}

در این سوال، شما در حال تنظیم مقادیر هایپرپارامترهای لایه‌ی کانولوشنی اول یک شبکه‌ی عصبی کانولوشنی هستید. ورودی شبکه تصویری با ابعاد $128 \times 128 \times 3$ است. هدف شما محاسبه‌ی ابعاد خروجی (ابعاد فعال‌سازی) و تعداد پارامترهای ممکن برای تنظیمات مختلف این لایه است. فرمت ابعاد به صورت \((H, W, C)\) است، که \(H\) ارتفاع، \(W\) عرض و \(C\) تعداد کانال‌ها را نشان می‌دهد.
(توجه کنید که هنگام محاسبه ابعاد در صورت اعشاری شدن از قطع کردن باید استفاده شود.)

\begin{enumerate}
    \item اولین لایه‌ی کانولوشنی دارای stride برابر با 1، filter size برابر با 3، input padding برابر با 0 و 64 فیلتر است.


    \vspace{3cm}

    



    \item اولین لایه‌ی کانولوشنی دارای stride برابر با 1، filter size برابر با 5، input padding برابر با 2 و 16 فیلتر است.
\vspace{3cm}


    \item اولین لایه‌ی کانولوشنی دارای stride برابر با 2، filter size برابر با 2، input padding برابر با 0 و 32 فیلتر است.
\vspace{4cm}


    اکنون که شکل‌های خروجی و تعداد پارامترهای این تنظیمات را تعیین کردید، قصد دارید یک شبکه عصبی کانولوشنی عمیق‌تر ایجاد کنید. فرض کنید یک شبکه شامل سه ماژول یکسان طراحی کرده‌اید که هر کدام از یک لایه کانولوشنی، یک لایه \lr{Max-Pooling} و یک لایه \lr{ReLU} تشکیل شده‌اند. تمام لایه‌های \lr{Pooling} دارای stride برابر با 2 و عرض/ارتفاع 2 هستند. به عنوان مثال، اگر لایه کانولوشنی دارای stride برابر با 1، filter size برابر با 1، input padding برابر با 0 و 8 فیلتر باشد، معماری هر ماژول به صورت زیر خواهد بود:
    \begin{itemize}
        \item کانولوشن $1 \times 1$ با stride برابر با 1 و input padding برابر با 0
        \item \lr{Max-Pool} با ابعاد $2 \times 2$ و stride برابر با 2
        \item \lr{ReLU}
    \end{itemize}
    \pagebreak


    سه ماژول مشابه را متوالی کنار هم میگذاریم تا شبکه کامل را تشکیل دهند. با توجه به مقادیر زیر برای هایپرپارامترهای کانولوشن، ابعاد خروجی فعال‌سازی و تعداد پارامترهای شبکه کامل را محاسبه کنید.

\item لایه‌های کانولوشنی دارای stride برابر با 1، filter size برابر با 3، input padding برابر با 0 و 64 فیلتر هستند.

    

\vspace{3cm}

\item لایه‌های کانولوشنی دارای stride برابر با 1، filter size برابر با 5، input padding برابر با 2 و 16 فیلتر هستند.

\vspace{3cm}


\item لایه‌های کانولوشنی دارای stride برابر با 2، filter size برابر با 2، input padding برابر با 0 و 32 فیلتر هستند.

\vspace{3cm}

\item فرض کنید برای حل یک مساله‌ی دسته‌بندی با 10 کلاس، شما یک لایه‌ی کاملاً متصل (Fully-Connected) بعد از سه ماژول کانولوشن-پولینگ-رلو اضافه می‌کنید. ورودی این لایه ، خروجی آخرین ماژول، به صورت flatten (کل داده را یک وکتور میکنیم) ، است. از میان سه معماری قبلی (قسمت‌های ۴، ۵ و ۶)، کدام معماری تعداد پارامترهای کمتری برای لایه‌ی کاملاً متصل خواهد داشت؟ تعداد پارامترهای این لایه را نیز مشخص کنید.

    

\end{enumerate}
